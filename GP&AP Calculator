import tkinter as tk
from tkinter import*
import googletrans
from textblob import*
from tkinter import ttk, messagebox
# Setting up tkinter to be used as a GUI. Root is the name of the parent where everything will go to.
root = tk.Tk()

#language list and grabbing langauges

global language_list
languages= googletrans.LANGUAGES
language_list = list(languages.values())


#Variables

    #Canvas and Background Varaibles 
geo = "500x300" 
canvaswidth = 500
canvasheight = 300
canvascolor ="#F0F8FF" #light colour used for canvaas

    #Label
global startnum, prognum, termnum, APnum, GPnum, transmsg, errormsg #making them accessible globally (will be useful for translation)
startnum = "Starting Number"
prognum = "Increment"
termnum = "Number of Terms"
APnum = "Arithmetic Progression"
GPnum = "Geometric Progression"
transmsg = "Translate"
Errormsg =  "ERROR! TYPE INTEGERS IN ALL BOXES"


    #Label settings
labelback = "White" #color for Label background
labeltextcol = "Black" #text color used for labels
labelfont = "Arial" #font for label
labelsize = 200


    #Starting number settings for AP and GP
startnumsize = 10
startnumx = 20
startnumy = 20
startnumtx = 180
startnumty = 20

    #Number of terms settings for AP and GP
numOftermsize = 10
numOFtermx = 20
numOFtermy = 70
numofsumtx = 180
numofsumty = 70

    #Progression number settings for AP and GP
progressionnumsize = 10
progressionnumx = 20
progressionnumy = 120
progressionnumtx=180
progressionnumty =120

    #Language combo box
boxwid = 45
boxx=10 
boxy=160


    #translator button settings
transy =155
transx =310
transsize = 10

    #AP radio button settings
APy = 180
APx= 10
APsize = 10

    #GP radio button settings
GPy = 180
GPx = 220
GPsize = 10






    #output
outx = 10
outy = 210
outwid = 380
outhei = 80



#Fucntions


def toggle_light_mode():
    global light_mode_var, dark_mode_var
    if light_mode_var.get() == False:
        dark_mode_var.set(True)
        dark_mode()
    else:
        dark_mode_var.set(False)
        light_mode()

def toggle_dark_mode():
    global light_mode_var, dark_mode_var
    if dark_mode_var.get() == False:
        light_mode_var.set(True)
        light_mode()
    else:
        light_mode_var.set(False)
        dark_mode()

def light_mode():
    global canvascolor, labelback, labeltextcol
    canvascolor = "#F0F8FF"
    labelback = "White"
    labeltextcol = "black"
    select_color = "white"  # Set the color of the dot for selected radio buttons
    # Update the colors for existing widgets
    frame.config(bg=canvascolor)
    Startingnum.config(bg=labelback, fg=labeltextcol)
    Numofterms.config(bg=labelback, fg=labeltextcol)
    Progressionnum.config(bg=labelback, fg=labeltextcol)
    AP.config(bg=canvascolor, fg = labeltextcol, activebackground=canvascolor, activeforeground=labeltextcol, selectcolor=select_color)
    GP.config(bg=canvascolor, fg =labeltextcol, activebackground=canvascolor, activeforeground=labeltextcol, selectcolor=select_color)
    trans.config(bg=canvascolor, fg="Black")
    ans.config(bg=labelback, fg=labeltextcol)


def dark_mode():
    global canvascolor, labelback, labeltextcol
    canvascolor = "#333333"
    labelback = "Black"
    labeltextcol = "White"
    select_color = "black"  # Set the color of the dot for selected radio buttons
    # Update the colors for existing widgets
    frame.config(bg=canvascolor)
    Startingnum.config(bg=labelback, fg=labeltextcol)
    Numofterms.config(bg=labelback, fg=labeltextcol)
    Progressionnum.config(bg=labelback, fg=labeltextcol)
    AP.config(bg=canvascolor, fg=labeltextcol, activebackground=canvascolor, activeforeground= labeltextcol, selectcolor=select_color)
    GP.config(bg=canvascolor, fg =labeltextcol, activebackground=canvascolor, activeforeground=labeltextcol, selectcolor=select_color)
    trans.config(bg=canvascolor, fg= "white")
    ans.config(bg=labelback, fg=labeltextcol)

def resolution1():
    geo="500x300"
    pass
def resolution2():
    geo="800x600"
    canvasheight = 600
    canvaswidth =800
    root.geometry(geo)
    root.maxsize(width=canvaswidth, height=canvasheight)
    root.minsize(width=canvaswidth, height=canvasheight)





def translate():
    global startnum, termnum, prognum, APnum, GPnum, transmsg, Errormsg
    try:
       if original.get() == translated.get(): #just a quick fix that retranslates it back to english
        Startingnum.config(text=startnum)
        Progressionnum.config(text=prognum)
        Numofterms.config(text=termnum)
        AP.config(text=APnum)
        GP.config(text=GPnum)
        trans.config(text=transmsg)
        if ans.get("1.0", "end-1c") == Errormsg:
            ans.config(state=NORMAL)
            ans.delete("1.0", tk.END)  # Clear the answer
            ans.insert(tk.END, Errormsg)
            ans.config(state=DISABLED)
        else:
            pass
       else:                                 #for every other language, this works
        #getting languges 
       #From languge 
        for key, value in languages.items():
            if (value == original.get()):
                from_languge_key =key
        #TO langauge 
        for key, value in languages.items():
            if (value == translated.get()):
                to_languge_key =key  
        
        #translating starting number
        words1 = TextBlob(startnum) #turn og text into textblob
        words1 = words1.translate(from_lang=from_languge_key , to=to_languge_key)
        
        Startingnum.config(text=words1)

        #translating progression number
        words2 = TextBlob(prognum) #turn og text into textblob
        words2 = words2.translate(from_lang=from_languge_key , to=to_languge_key)
        
        Progressionnum.config(text=words2)

        #translating number of terms
        words3 = TextBlob(termnum) #turn og text into textblob
        words3 = words3.translate(from_lang=from_languge_key , to=to_languge_key)
        Numofterms.config(text=words3)

        #translating the AP button
        words4 = TextBlob(APnum) #turn og text into textblob
        words4 = words4.translate(from_lang=from_languge_key , to=to_languge_key)
        AP.config(text=words4)

        #translating the GP button
        words5 = TextBlob(GPnum) #turn og text into textblob
        words5 = words5.translate(from_lang=from_languge_key , to=to_languge_key)
        GP.config(text=words5)

        #translating the Translate button
        words6 = TextBlob(transmsg) #turn og text into textblob
        words6 = words6.translate(from_lang=from_languge_key , to=to_languge_key)
        trans.config(text=words6)

        if ans.get("1.0", "end-1c") == Errormsg:
            ans.config(state=NORMAL)
            ans.delete("1.0", tk.END)  # Clear the answer
            words7 = TextBlob(Errormsg) #turn og text into textblob
            words7 = words7.translate(from_lang=from_languge_key , to=to_languge_key)
            ans.insert(tk.END, words7)
            ans.config(state=DISABLED)
        else:
            pass



    except Exception as e:
        messagebox.showerror("Translate Error", e)

        

def clear():
    pass

def Arithmetic():
    ans.config(state=tk.NORMAL)  # Resets the state of text widget
    ans.delete(1.0, tk.END)  # Clear the previous output


    if not (StartingnumTxt.get().isdecimal() and Progressionnumtxt.get().isdecimal() and NumoftermsTxt.get().isdecimal()): #Checks whether the values are integers or not
        ans.insert(tk.END, Errormsg) #IF they aren't then it gives an error
        ans.config(state=DISABLED)
    else:                                                          #Else does the calculation
        final = 0
        tempnum = 1
        list = []
        first = int(StartingnumTxt.get())
        prog = int(Progressionnumtxt.get())
        while tempnum <= int(NumoftermsTxt.get()):
            final = first + (tempnum - 1)*prog
            tempnum += 1
            list.append(str(final))
        ans.insert(tk.END, " ".join(list)) #Adds the number to the end
        ans.config(state=tk.DISABLED)  # Make the Text widget read-only


def Geometric():
    ans.config(state=tk.NORMAL)  # Resets the state of text widget
    ans.delete(1.0, tk.END)  # Clear the previous output

    if not (StartingnumTxt.get().isdecimal() and Progressionnumtxt.get().isdecimal() and NumoftermsTxt.get().isdecimal()): #Checks whether the values are integers or not
        ans.insert(tk.END, "ERROR! TYPE INTEGERS IN ALL BOXES") #IF they aren't then it gives an error
        ans.config(state=DISABLED)
    else:                                                          #Else does the calculation




        final = 0
        tempnum = 1
        list = []
        first = int(StartingnumTxt.get())
        prog = int(Progressionnumtxt.get())
        while tempnum <= int(NumoftermsTxt.get()):
            final = first *(prog**(tempnum-1))
            tempnum += 1
            list.append(str(final))
        ans.insert(tk.END, " ".join(list)) #adds the number to the end
        ans.config(state=tk.DISABLED)  # Make the Text widget read-only



def destroy():
    root.destroy()


def calculator():
    root.title("AP and GP calculator")
    root.geometry(geo)
    root.maxsize(width=canvaswidth, height=canvasheight)
    root.minsize(width=canvaswidth, height=canvasheight)







    global ans, frame
    #Setting up the frame
    frame = tk.Frame(root, bg=canvascolor) #was going to use canvas but frame seemed better
    frame.pack(fill=tk.BOTH, expand=True) #fills horizontal and vertical and also expands it

    #Menu
    menubar = tk.Menu(root)
    root.config(menu=menubar)

        #Adding a file button
    file_menu = tk.Menu(menubar, tearoff=0) #makng a parent 
    menubar.add_cascade(label='File', menu=file_menu) #naming the parent file
    
        #making the themes menu a parant 
    theme_menu =tk.Menu(file_menu, tearoff=0) 
        #adding the themes menu
    file_menu.add_cascade(label='Theme', menu=theme_menu)



        #adding resolution
    resolution_menu =tk.Menu(file_menu, tearoff=0)
    file_menu.add_cascade(label='Resolution', menu=resolution_menu)
            #adding resolutions to the resolution menu
    resvar = IntVar(value=1)
    resolution_menu.add_radiobutton(label='500x300', command=None, value=1, variable=resvar)
    resolution_menu.add_radiobutton(label='700x400', command=resolution2, value=2, variable=resvar)
    resolution_menu.add_radiobutton(label='800x500', command=None, value=3, variable=resvar)


        #exit button
    file_menu.add_cascade(label='Exit', command=destroy)

    global light_mode_var, dark_mode_var
    light_mode_var = tk.BooleanVar(value=True)  # Initially, light mode is on
    dark_mode_var = tk.BooleanVar(value=not light_mode_var.get()) #does the opposite of light_mode_var, so if light mode var is off this will be on

    
    theme_menu.add_checkbutton(label='Light mode', command=toggle_light_mode ,onvalue = True,offvalue = False, variable=light_mode_var)
    theme_menu.add_checkbutton(label='Dark mode', variable=dark_mode_var, command=toggle_dark_mode)



    
    #Labels
        #Starting number
    global Startingnum
    Startingnum = tk.Label(frame, text=(startnum), font=(labelfont, startnumsize), bg=labelback, fg=labeltextcol)
    Startingnum.place(x=startnumx, y=startnumy)

        #Number of Terms
    global Numofterms
    Numofterms = tk.Label(frame, text=(termnum), font=(labelfont, numOftermsize), bg=labelback, fg=labeltextcol)
    Numofterms.place(x=numOFtermx, y=numOFtermy)
    
        #Progression Number
    global Progressionnum
    Progressionnum =tk.Label(frame, text=(prognum), font=(labelfont, progressionnumsize), bg=labelback, fg=labeltextcol)
    Progressionnum.place(x=progressionnumx, y=progressionnumy)

    #Entries 

    global StartingnumTxt
    StartingnumTxt = tk.Entry(frame, font=(labelfont, startnumsize), bg=labelback, fg=labeltextcol)
    StartingnumTxt.place(x=startnumtx, y=startnumty, width=labelsize)

    global NumoftermsTxt
    NumoftermsTxt = tk.Entry(frame, font=(labelfont, numOftermsize), bg=labelback, fg=labeltextcol)
    NumoftermsTxt.place(x=numofsumtx, y=numofsumty, width=labelsize)

    global Progressionnumtxt
    Progressionnumtxt = tk.Entry(frame, font=(labelfont, progressionnumsize), bg=labelback, fg=labeltextcol)
    Progressionnumtxt.place(x=progressionnumtx, y=progressionnumty, width=labelsize)


    #Radiobuttons


    global AP, GP, trans, APvar, GPvar

    ranvar = tk.IntVar(value=0)  # Variables to store the selected value for AP radio button
    ranvar = tk.IntVar(value=0) # value = 0 makes it unselected when code is launched
    AP = tk.Radiobutton(frame, text="Arithmetic Progression", command=Arithmetic, value=1, font=(labelfont, APsize), bg=canvascolor, fg="black", variable=ranvar)
    AP.place(x=APx, y=APy)
    GP = tk.Radiobutton(frame, text="Geometric Progression", command=Geometric, value=2, font=(labelfont, GPsize), bg=canvascolor, fg="black", variable=ranvar)
    GP.place(x=GPx, y=GPy)

    #buttons 
    trans = tk.Button(frame, text="Translate", command=translate, font=(labelfont, transsize), bg=canvascolor, fg="black")
    trans.place(x=transx,y=transy)

    #Textbox
    original_text = Text(frame)
    translated_text = Text(frame)


    #Combo Box
    global original
    
    original = ttk.Combobox(frame, width=boxwid, value=language_list)
    original.current(21)
    
    global translated
    translated = ttk.Combobox(frame, width=boxwid, value=language_list)
    translated.current(26)
    translated.place(x=boxx,y=boxy)

    #output 

        #Frame for the output
    output = tk.Frame(frame, bg=canvascolor)
    output.place(x=outx, y=outy, width=outwid, height=outhei)
   
        #Answer label placed in the output frame
    global ans
    ans = tk.Text(output, font=(labelfont, 15), wrap=tk.NONE, fg="black")#wrap basically choses what to do when the text goes over the box, in this case it is set to none as we will be using a scroll bar.
    ans.pack(side=tk.LEFT, fill=tk.BOTH, expand=True) #side command moves it all the way to the left of the output frame, fill makes sure that both horizontal and vertical axises are occupied and expand makes it useable when expanded

        #Scroll bar used in the answer
    scroll = tk.Scrollbar(output, command=ans.yview)#the scrollbar is set so that it will be vertical
    scroll.pack(side=tk.RIGHT, fill=tk.Y)#goes to the right side of the frame and fills the y axis
 
    ans.config(yscrollcommand=scroll.set, wrap=tk.WORD) #sets up the scrollbar and wraps the text with a word boundary
    
    root.mainloop()

    







if __name__ == "__main__": #checks if it is the main program
    calculator()